# OpenGL ES

## 简介

**OpenGL ES (OpenGL for Embedded Systems)** 是以⼿持和嵌⼊式为目标的⾼级**3D**图形应用程序编程接⼝**(API). OpenGL ES **是⽬前智能手机中占据统治地位的图形 **API**。⽀持的平台: iOS, Andriod , BlackBerry ,bada ,Linux ,Windows。

OpenGL ES 开放式图形库(OpenGL)⽤于可视化的二维和三维数据。它是一个多功能开放标准图形库，支持2D和3D数字内容创建，机械和建筑设计，虚拟原型设计，飞行模拟，视频游戏等应用程序。您可以使用OpenGL配置3D图形管道并向其提交数据。顶点被变换和点亮，组合成图元，并光栅化以创建2D图像。OpenGL旨在将函数调用转换为可以发送到底层图形硬件的图形命令。由于此底层硬件专用于处理图形命令，因此OpenGL绘图通常非常快。

OpenGL for Embedded Systems(OpenGL ES)是OpenGL的简化版本，它消除了冗余功能，提供了一个既易于学习⼜更易于在移动图形硬件中实现的库。

下图展示了 OpenGL ES 3.0 图形管线，顶点着色器和片段着色器为可编程阶段。

<img src="./img/08-001 OpenGL ES 3.0 图形管线.png" style="zoom:50%;" />

#### 顶点着色器

顶点着色器实现了顶点操作的通用可编程方法。

顶点着色器的输入包括：

- 着色器程序 —— 描述顶点上执行操作的顶点着色器程序源代码或者可执行文件。
- 顶点着色器输入（属性）—— 用顶点数组提供的每个顶点的数据。
- 统一变量（uniform）—— 顶点/片段/片元着色器使用的不变数据。
- 采样器 —— 代表顶点着色器使用纹理的特殊统一变量类型。

顶点着色器可以用于通过矩阵变换位置、计算照明公式来生成逐顶点颜色以及生成或者变换纹理坐标等基于顶点的传统操作。此外，因为顶点着色器由应用程序规定，所以它可以用于执行自定义计算，实施新的变换、照明或者较传统的固定功能管线所不允许的基于顶点的效果。

顶点着色器 业务：

- 矩阵变换位置
- 计算光照公式生成逐顶点颜色
- 生成/变换纹理坐标

**总结：**它可以用于执⾏自定义计算，实施新的变换，照明或者传统的固定功能所不允许的基于顶点的效果。

#### 图元装配

顶点着色器之后，下一阶段是图元装配。

图元（Primitive）：点，线，三角形等。

图元装配：将顶点数据计算成一个个图元。在这个阶段会执行裁剪、透视分割和 Viewport 变换操作。

图元类型和顶点所确定将被渲染的单独图元。对于每个单独图元及其对应的顶点，图元装配阶段执⾏的操作包括：将顶点着⾊器的输出值执⾏裁剪、透视分割、视口变换后进⼊光栅化阶段。

#### 光栅化

在这个阶段绘制对应的图元(点/线/三⻆角形)。光栅化就是将图元转化成⼀组⼆维⽚段的过程。而这些转化的⽚段将由⽚元着⾊器处理。这些⼆维⽚段就是屏幕上可绘制的像素。

<img src="./img/08-002 OpenGL ES 3.0 光栅化阶段.png" style="zoom:50%;" />

#### 片元着色器

顶点着色器的输入包括：

- 着色器程序 —— 描述片段上执行操作的片段着色器程序源代码或者可执行文件。
- 输入变量 —— 光栅化单元用茶质为每个片段生成的顶点着色器输出。
- 统一变量 —— 顶点/片段/片元着色器使用的不变数据。
- 采样器 —— 代表片段着色器使用纹理的特殊统一变量类型。

顶点着色器 业务：

- 计算颜色
- 获取纹理值
- 往像素点中填充颜色值（纹理值/颜色值）

**总结：**它可以⽤于图⽚/视频/图形中每个像素的颜色填充（比如给视频添加滤镜，实际 上就是将视频中每个图片的像素点颜色填充进行修改）。

#### 逐片段操作























