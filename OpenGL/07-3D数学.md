# 3D数学

## 向量

| 公式                                                         | 解释                                           |
| ------------------------------------------------------------ | ---------------------------------------------- |
| **a** + **b** = **b** + **a**                                | 向量加法的交换律                               |
| **a** - **b** = **a** + (-**b**)                             | 向量减法的定义                                 |
| (**a** + **b**) + **c** = **a** + (**b** + **c**)            | 向量加法的结合律                               |
| *s*(*t***a**) = (*st*)**a**                                  | 标量乘法的结合律                               |
| *k*(**a** + **b**) = *k***a** + *k***b**                     | 标量乘法对向量加法的分配律                     |
| ‖*k***a**‖ = \|*k*\|‖**a**‖                                  | 向量乘以标量相当于以标量多绝对值为因子缩放向量 |
| ‖**a**‖ ≥ 0                                                  | 想来给你的大小非负                             |
| ‖**a**‖$^2$ + ‖**b**‖ $^2$= ‖**a** + **b**‖$^2$              | 勾股定理在向量加法中的应用                     |
| ‖**a**‖ + ‖**b**‖ ≥ ‖**a** + **b**‖                          | 向量加法的三角形法则                           |
| **a** • **b** = **b** • **a**                                | 点乘的交换律                                   |
| ‖**a**‖ = √**a**•**a**​                                       | 用点乘定义向量大小                             |
| *k*(**a** • **b**) = (*k***a**) • **b** = **a** • (*k***b**) | 标量乘法对点乘的结合律                         |
| **a** • (**b** + **c**) = **a** • **b** + **a** • **c**      | 点乘对向量加法的分配律                         |
| **a** x **a** = 0                                            | 任意向量与自身的叉乘等于零向量                 |
| **a** x **b** = -(**b** x **a**)                             | 叉乘逆交换律                                   |
| **a** x **b** = (-**a**) x (-**b**)                          | 叉乘的操作数同时变负得到相同的结果             |
| *k*(**a** x **b**) = (*k***a**) x **b** = **a** x (*k***b**) | 标量乘法对叉乘的结合律                         |
| **a** x (**b** + **c**) = **a** x **b** + **a** x **c**      | 叉乘对向量加法的分配律                         |
| **a** • (**a** x **b**) = 0                                  | 向量与另一向量的叉乘再点乘该向量本身等于零     |



## 矩阵

### 矩阵-数学定义

#### 对角矩阵

$\begin{bmatrix}
   3 & 0 & 0 \\
   0 & 2 & 0 \\
   0 & 0 & -2
\end{bmatrix}$

#### 单位矩阵

$\begin{bmatrix}
   1 & 0 & 0 \\
   0 & 1 & 0 \\
   0 & 0 & 1
\end{bmatrix}$

#### 转置

$\begin{bmatrix}
   a & b & c \\
   d & e & f \\
   g & h & i
\end{bmatrix}^T$= $\begin{bmatrix}
   a & d & g \\
   b & e & h \\
   c & f & i
\end{bmatrix}$

$\begin{bmatrix}
   x & y & z
\end{bmatrix}^T$= $\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}$

$\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}^T$= $\begin{bmatrix}
   x & y & z
\end{bmatrix}$

- 对于任意矩阵 **M**，**(M$^T$)$^T$ = M **。从另一方面来说，将一个矩阵转置后，再转置一次，便会得到原矩阵。这条法则对向量也适用。
- 对于任意对角矩阵 **D**，都有 **D$^T$ = D**，包括单位矩阵 **I** 也如此。

#### 标量和矩阵的乘法

*k***M** = *k*$\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix}$ = $\begin{bmatrix}
   km_1 & km_2 & km_3 \\
   km_4 & km_5 & km_6 \\
   km_7 & km_8 & km_9
\end{bmatrix}$

#### 矩阵相乘

一个 **r X n** 矩阵 **A** 能够乘以一个 **n x c** 矩阵 **B**，结果是一个 **r x c** 矩阵，记作 **AB**。

   **A**          				**B** 									**AB**

$\begin{bmatrix}
   ? & ? \\
   ? & ? \\
   ? & ? \\
   ? & ?
\end{bmatrix}$ $\begin{bmatrix}
   ? & ? & ? & ? & ? \\
   ? & ? & ? & ? & ?
\end{bmatrix}$ = $\begin{bmatrix}
   ? & ? & ? & ? & ? \\
   ? & ? & ? & ? & ? \\
   ? & ? & ? & ? & ? \\
   ? & ? & ? & ? & ?
\end{bmatrix}$

**AB** = $\begin{bmatrix}
   a_1 & a_2 & a_3 \\
   a_4 & a_5 & a_6 \\
   a_7 & a_8 & a_9
\end{bmatrix}$ $\begin{bmatrix}
   b_1 & b_2 & b_3 \\
   b_4 & b_5 & b_6 \\
   b_7 & b_8 & b_9
\end{bmatrix}$ 

​      = $\begin{bmatrix}
   a_1b_1 + a_2b_4 + a_3b_7 & a_1b_2 + a_2b_5 + a_3b_8 & a_1b_3 + a_2b_6 + a_3b_9 \\
   a_4b_1 + a_5b_4 + a_6b_7 & a_4b_2 + a_5b_5 + a_6b_8 & a_4b_3 + a_5b_6 + a_6b_9 \\
   a_7b_1 + a_8b_4 + a_9b_7 & a_7b_2 + a_8b_5 + a_9b_8 & a_7b_3 + a_8b_6 + a_9b_9
\end{bmatrix}$

换种写法，方便观察理解

​			  				$\begin{bmatrix}
   b_1 & b_2 & b_3 \\
   b_4 & b_5 & b_6 \\
   b_7 & b_8 & b_9
\end{bmatrix}$						

$\begin{bmatrix}
   a_1 & a_2 & a_3 \\
   a_4 & a_5 & a_6 \\
   a_7 & a_8 & a_9
\end{bmatrix}$ $\begin{bmatrix}
   a_1b_1 + a_2b_4 + a_3b_7 & a_1b_2 + a_2b_5 + a_3b_8 & a_1b_3 + a_2b_6 + a_3b_9 \\
   a_4b_1 + a_5b_4 + a_6b_7 & a_4b_2 + a_5b_5 + a_6b_8 & a_4b_3 + a_5b_6 + a_6b_9 \\
   a_7b_1 + a_8b_4 + a_9b_7 & a_7b_2 + a_8b_5 + a_9b_8 & a_7b_3 + a_8b_6 + a_9b_9
\end{bmatrix}$

- 任意矩阵 **M** 乘以方阵 **S**，不管从哪边乘，都将得到与原矩阵大小相同的矩阵。如果 **S** 是单位矩阵，结果将是原矩阵 **M**。
- 矩阵乘法不满足交换律，即：**AB≠BA**。
- 矩阵乘法满足结合律，即：**(AB)C = A(BC)**。
- 矩阵乘法也满足于标量或向量的结合律，即：**(kA)B = k(AB) = A(kB)** 。
- 矩阵积的转置相当于县转置矩阵然后以相反的顺序乘：**(AB)$^T$ = B$^T$A$^T$**

#### 向量与矩阵的乘法

因为向量能被当作是一行或一列的矩阵，所有能够用前一节所讨论的规则与矩阵相乘。

$\begin{bmatrix}
   x & y & z
\end{bmatrix}$ $\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix}$ = $\begin{bmatrix}
   xm_1 + ym_4 + zm_7 & xm_2 + ym_5 + zm_8 & xm_3 + ym_6 + zm_9
\end{bmatrix}$

$\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix}$ $\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}$ = $\begin{bmatrix}
   xm_1 & ym_2 & zm_3 \\
   xm_4 & ym_5 & zm_6 \\
   xm_7 & ym_8 & zm_9
\end{bmatrix}$

$\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix}$ $\begin{bmatrix}
   x & y & z
\end{bmatrix}$ = (无定义)

$\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}$ $\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix}$ = (无定义)

行向量左乘矩阵，结果是行向量；列向量右乘矩阵，结果是列向量。另外两种组合是不允许的。

- 结果向量中的每个元素多是原向量与矩阵中单独行或列的点积。
- 矩阵中的元素决定了输入向量中特定元素在输出向量中占的比重。如，*m$_1$*决定了输入 *x* 对输出 *x* 值的贡献。
- 矩阵-向量乘法满足对向量加法的分配律。对于向量 **v**、**w** 和矩阵 **M**，有：**(v+w)M = vM + wM**

### 矩阵-几何解释

一般来说，方阵能描述任意**线性变换**。

- 旋转
- 缩放
- 投影
- 镜像
- 仿射

#### 矩阵是怎样变换向量的

向量在几何上能被解释成一系列与轴平行的位移。如，向量 [1, -3, 4] 能被解释成位移 [1, 0, 0]，随后位移 [0, -3, 0]，最后位移 [0, 0, 4]。

一般来说，任意向量 **v** 都能写成“扩展“形式：

**v** = $\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}$ = $\begin{bmatrix}
   x \\
   0 \\
   0
\end{bmatrix}$ + $\begin{bmatrix}
   0 \\
   y \\
   0
\end{bmatrix}$ + $\begin{bmatrix}
   0 \\
   0 \\
   z
\end{bmatrix}$

另一种略有差别的形式：

**v** = $\begin{bmatrix}
   x \\
   y \\
   z
\end{bmatrix}$ = *x*$\begin{bmatrix}
   1 \\
   0 \\
   0
\end{bmatrix}$ + *y*$\begin{bmatrix}
   0 \\
   1 \\
   0
\end{bmatrix}$ + *z*$\begin{bmatrix}
   0 \\
   0 \\
   1
\end{bmatrix}$

右边的单位向量就是 x，y，z 轴。

将上面的向量和重新写一遍，分别用 **p**，**g** 和 **r**。定义为指向 +x，+y 和 +z 方向的单位向量：

**v** = *x***p** + *y***q** + *z***r**

将向量表示为基向量的线性组合，向量 **v** 就被表示成向量 **p**，**q**，**r** 的线性变换了。

以 **p**，**q**，**r** 为行构建一个 3x3 矩阵 **M**，可得：

**M** = $\begin{bmatrix}
   p \\
   q \\
   r
\end{bmatrix}$ $\begin{bmatrix}
   p_x & p_y & p_z \\
   q_x & q_y & q_z \\
   r_x & r_y & r_z
\end{bmatrix}$

用一个向量乘以该矩阵，得到：

$\begin{bmatrix}
   x & y & z
\end{bmatrix}$ $\begin{bmatrix}
   p_x & p_y & p_z \\
   q_x & q_y & q_z \\
   r_x & r_y & r_z
\end{bmatrix}$ = $\begin{bmatrix}
   xp_x + yq_x + zr_x & xp_y + yq_y + zr_y & xp_z + yq_z + zr_z
\end{bmatrix}$ = x**p** + y**q** + z**r**

这和前面计算转换后的 **v** 的等式相同。

> 如果把矩阵的行解释为坐标系的基向量，那么乘以该矩阵就相当于执行了一次坐标转换。若有 **aM = b** ，我们就可以说，**M** 将 **a** 转换到 **b** 。

矩阵并不神秘，它只是用一种紧凑的方式表达坐标转换所需的数学运算。进一步，用线性代数操作矩阵，是一种进行简单转换或导出更复杂转换的简单方法。



## 矩阵和线性变换

### 旋转

#### 2D中的旋转

2D 中绕原点旋转只有一个参数：角度 *θ* ，它描述了旋转量。逆时针旋转经常被认为是正方向，顺时针方向是负方向。

基向量 **p**，**q** 绕原点旋转，得到新的基向量 **p'**​，**q'** 。
$$
R(θ) 
= 
\begin{bmatrix}
   p' \\
   q'
\end{bmatrix}  
= 
\begin{bmatrix}
   cosθ & sinθ \\
   -sinθ & cosθ
\end{bmatrix}
$$

#### 3D中绕坐标轴的旋转

绕轴旋转 *θ˚* 时，必须知道哪个方向被认为“正”，哪个方向被认为“负”，左手坐标系中定义此方向的规则为左手法则。首先，要明确旋转轴指向哪个方向。当然，旋转轴在理论上是无限延伸的，但我们还是要认为它有正端点和负端点。与笛卡尔坐标轴定义坐标系相同，左手法则是这样的:伸出左手，大拇指向上，其余四指弯曲。大拇指指向旋转轴的正方向，此时，四指弯曲的方向就是旋转的正方向。

绕 x 轴旋转，求出旋转后的基向量，可以得到矩阵：
$$
R_x(θ) 
= 
\begin{bmatrix}
   p' \\
   q' \\
   r'
\end{bmatrix}  
= 
\begin{bmatrix}
   1 & 0 & 0 \\	
   0 & cosθ & sinθ \\
   0 & -sinθ & cosθ
\end{bmatrix}
$$
绕 y 轴旋转，可得绕 y 轴旋转的矩阵：
$$
R_y(θ) 
= 
\begin{bmatrix}
   p' \\
   q' \\
   r'
\end{bmatrix}  
= 
\begin{bmatrix}
   cosθ & 0 & -sinθ \\	
   0 & 1 & 0 \\
   sinθ & 0 & cosθ
\end{bmatrix}
$$
绕 z 轴旋转，得到矩阵：
$$
R_z(θ) 
= 
\begin{bmatrix}
   p' \\
   q' \\
   r'
\end{bmatrix}  
= 
\begin{bmatrix}
   cosθ & sinθ & 0 \\	
   -sinθ & cosθ & 0 \\
   0 & 0 & 1
\end{bmatrix}
$$

#### 3D中绕任意轴的旋转

当然也能绕3D中的任意轴旋转。因为这里不考虑平移，可以假设旋转轴通过原点。这种旋转比绕坐标轴的旋转更复杂也更少见。用单位向量n描述旋转轴，和前面一样用0描述旋转量。
导出绕轴n旋转角度日的矩阵。也就是说，我们想得到满足下面条件的矩阵 **R(n,θ)**
$$
vR(n,θ) = v’
$$

### 缩放

我们可以通过让比例因子 *k* 按比例变大或缩小来缩放物体。如果在各方向应用同比例的缩放，并且沿原点“膨胀”物体，那么就是均匀缩放。均匀缩放可以保持物体的角度和比例不变。如果长度増加或减小因子 *k*，则面积增加或减小因子 *$k^2$*，在 3D 中，体积的因子是 *$k^3$*。
如果需要“挤压”或“拉伸”物体，在不同的方向应用不同的因子即可，这称作**非均匀缩放**。非均匀缩放时，物体角度将发生变化。视各方向缩放因子的不同，长度、面积、体积的变化因子也各不相同。

#### 沿坐标轴缩放

2D 中有两个缩放因子， $k_x$ 和 $k_y$ 。
$$
S(k_x,k_y)
=
\begin{bmatrix}
   k_x & 0 \\
   0 & k_y'
\end{bmatrix}
$$
3D 中需要三个缩放因子，$k_x$，$k_y$ 和 $k_z$ 。
$$
S(k_x,k_y,k_z)
=
\begin{bmatrix}
   k_x & 0 & 0 \\
   0 & k_y' & 0 \\
   0 & 0 & k_z
\end{bmatrix}
$$

#### 沿任意方向缩放

可以不依赖于坐标系而沿任意方向进行缩放。设 **n** 为平行于缩放方向的单位向量，*k* 为缩放因子，缩放沿穿过原点并平行于 **n** 的直线（2D 中）或平面（3D中）进行。
$$
S(n,k)
=
\begin{bmatrix}
   p' \\
   q'
\end{bmatrix}
=
\begin{bmatrix}
   1+(k-1)n^2_x & (k-1)n_xn_y \\
   (k-1)n_xn_y & 1+(k-1)n^2_y
\end{bmatrix}
$$

$$
S(n,k)
=
\begin{bmatrix}
   p' \\
   q' \\
   r'
\end{bmatrix}
=
\begin{bmatrix}
   1+(k-1)n^2_x & (k-1)n_xn_y & (k-1)n_xn_z \\
   (k-1)n_xn_y & 1+(k-1)n^2_y & (k-1)n_yn_z \\
   (k-1)n_xn_z & (k-1)n_zn_y & 1+(k-1)n^2_z
\end{bmatrix}
$$



### 正交投影

所有的点都被拉平至垂直的轴（2D）或平面（3D）上。这种类型的投影称作**正交投影**，或者**平行投影**，因为从原来的点到投影点到直线都是平行的。

#### 向坐标轴后平面上投影

向坐标轴或平面投影在实际变换中不常发生，大多数情况是向低维的变量赋值，且要抛弃维数时。例如，将3D点赋值给2D点，抛弃z分量，只复制x和y。
通过使垂直方向上的缩放因子为零，就能向坐标轴或平面投影。

向 x 轴投影的 2D 矩阵：
$$
P_x
=
S(\begin{bmatrix}
   0 & 1
\end{bmatrix}, 0)
=
\begin{bmatrix}
   1 & 0 \\
   0 & 0
\end{bmatrix}
$$
向 y 轴投影的 2D 矩阵：
$$
P_x
=
S(\begin{bmatrix}
   1 & 0
\end{bmatrix}, 0)
=
\begin{bmatrix}
   0 & 0 \\
   0 & 1
\end{bmatrix}
$$
向 xy 轴投影的 3D 矩阵：
$$
P_x~_y
=
S(\begin{bmatrix}
   0 & 0 & 1
\end{bmatrix}, 0)
=
\begin{bmatrix}
   1 & 0 & 0 \\
   0 & 1 & 0 \\
   0 & 0 & 0
\end{bmatrix}
$$
向 xz 轴投影的 3D 矩阵：
$$
P_x~_z
=
S(\begin{bmatrix}
   0 & 1 & 0
\end{bmatrix}, 0)
=
\begin{bmatrix}
   1 & 0 & 0 \\
   0 & 0 & 0 \\
   0 & 0 & 1
\end{bmatrix}
$$
向 yz 轴投影的 3D 矩阵：
$$
P_y~_z
=
S(\begin{bmatrix}
   1 & 0 & 0
\end{bmatrix}, 0)
=
\begin{bmatrix}
   0 & 0 & 0 \\
   0 & 1 & 0 \\
   0 & 0 & 1
\end{bmatrix}
$$

#### 向任意直线或平面投影

也能向任意直线或平面投影。由于不考虑平移，这些直线或平面必须通过原点。投影由垂直于直线或平面的单位向量 **n** 定义。
通过使该方向的缩放因子为零能够导出向任意方向投影的矩阵。

向任意直线投影的 2D 矩阵：
$$
P(n)
= 
S(n,0)
= 
S(\begin{bmatrix}
   1+(0-1)n^2_x & (0-1)n_xn_y \\
   (0-1)n_xn_y & 1+(0-1)n^2_y
\end{bmatrix})
=
S(\begin{bmatrix}
   1-n^2_x & -n_xn_y \\
   -n_xn_y & 1-n^2_y
\end{bmatrix})
$$
这里 **n** 垂直于投影直线，而不是平行。3D中，向垂直于 **n** 的平面投影的矩阵。

向任意直线投影的 3D 矩阵：
$$
P(n)
= 
S(n,0)
= 
S(\begin{bmatrix}
   1+(0-1)n^2_x & (0-1)n_xn_y & (0-1)n_xn_z \\
   (0-1)n_xn_y & 1+(0-1)n^2_y & (0-1)n_yn_z \\
   (0-1)n_xn_z & (0-1)n_zn_y & 1+(0-1)n^2_z
\end{bmatrix})
=
S(\begin{bmatrix}
   1-n^2_x & -n_xn_y & -n_xn_z \\
   -n_xn_y & 1-n^2_y & -n_yn_z \\
   -n_xn_z & -n_zn_y & 1-n^2_z
\end{bmatrix})
$$


### 镜像

镜像（也叫作反射）是一种变换，其作用是将物体沿直线（2D 中）或平面（3D 中）“翻折”。使缩放因子为 -1能够很容易地实现镜像变换。



### 切变

切变是一种坐标系“扭曲”变换，非均匀地拉伸它。切变的时候角度会发生变化，但令人惊奇的是面积和体积却保持不变。基本思想是将某一坐标的乘积加到另一个上。例如，2D中，将 y 乘以某个因子然后加到 x 上，得到 **x'=x+sy** 。



### 变换分类

#### 线性变换

如果映射 **F** 保持了基本运算:加法和数量乘，那么就可以称该映射为线性的。在这种情况下，将两个向量相加然后再进行变换得到的结果和先分别进行变换再将变换后的向量相加得到的结果相同。同样，将一个向量数量乘再进行变换和先进行变换再数量乘的结果也是一样的。
$$
F(a+b)=F(a)+F(b)
$$

- 映射 **F(a)=aM**，当 **M** 为任意方阵时，说映射时一个线性变换。
- 零向量的任意线性变换的结果仍然是零向量。

#### 仿射变换

仿射变换是指线性变换后接着平移。因此，仿射变换的集合是线性变换的超集，任何线性变换都是仿射变换，但不是所有仿射变换都是线性变换。任何具有形式 *v'* = *v***M** + **b** 的变换都是仿射变换。

#### 可逆变换

如果存在一个逆变换可以“撤消”原变换，那么该变换是可逆的。换句话说，如果存在逆变换 $F^-$$^1$，使得 **$F^-$$^1$(F(a)) = a**，对于任意 **a**，映射 **F(a)** 是可逆的。

基本变换除了投影都是可逆的。因为任意线性变换都能表达为矩阵，所以求逆变换等价于求矩阵的逆。如果矩阵是**奇异**的，则变换**不可逆**；可逆矩阵的行列式不为零。

#### 等角变换

如果变换前后两向量夹角的大小和方向都不改变，该变换是等角的。只有平移，旋转和均匀缩放是等角变换。等角变换将会保持比例不变。镜像并不是等角变换，因为尽管两向量夹角的大小不变，但夹角的方向改变了。所有等角变换都是仿射和可逆的。

#### 正交变换

术语“正交”用来描述具有某种性质的矩阵。正交变换的基本思想是轴保持互相垂直，而且不进行缩放变换。正交变换很有意思，因为很容易求出它的逆。

平移、旋转和镜像是仅有的正交变换。长度、角度、面积和体积都保持不变。（尽管如此，但因为镜像变换被认为是正交变换，所以一定要密切注意角度、面积和体积的准确定义）。

所有正交矩阵都是仿射和可逆的。

#### 刚体变换

刚体变换只改变物体的位置和方向，不包括形状。所有长度、角度、面积和体积都不变。平移和旋转是仅有的刚体变换，镜像并不被认为是刚体变换。

刚体变换也被称作正规变换。所有刚体变换都是正交、等角、可逆和仿射的。

某些刚体变换旋转矩阵的行列式为1。



## 矩阵的更多知识

### 矩阵的行列式

在任意方阵中都存在一个标量，称作该方阵的行列式。在线性代数中，行列式有很多有用的性质，它的几何解释也是非常有趣的。

#### 线性运算法则

方阵 $M$ 的行列式记作 $|M|$ 或 **“det M”** 。非方阵矩阵的行列式是未定义的。
$$
|M| 
=
\begin{bmatrix}
   m_1 & m_2 \\
   m_3 & m_4
\end{bmatrix}
= 
m_1m_4 - m_2m_3
$$
3 X 3 阶矩阵的行列式定义：
$$
\begin{bmatrix}
   m_1 & m_2 & m_3 \\
   m_4 & m_5 & m_6 \\
   m_7 & m_8 & m_9
\end{bmatrix} 
= m_1m_5m_9 + m_2m_6m_7 + m_3m_4m_8 - m_3m_5m_7 - m_2m_4m_9 - m_1m_6m_8 \\
= m_1(m_5m_9 - m_6m_8) + m_2(m_6m_7 - m_4m_9) + m_3(m_4m_8 - m_5m_7)
$$
如果将 3x3 阶矩阵的行解释为3个向量，那么矩阵的行列式等于这些向量的所谓“三元组积”。

假设矩阵 $M$ 有 *r* 行，*c* 列。记法 $M^{\{ij\}}$ 表示从 $M$ 中去除第 $i$ 行和第 $j$ 列后剩下的矩阵。矩阵 $M^{\{ij\}}$ 称作 $M$ 的**余子式**。
$$
\begin{bmatrix}
   -4 & -3 & 3 \\
   0 & 2 & -2 \\
   1 & 4 & -1
\end{bmatrix}
=>
M^{\{12\}}
=
\begin{bmatrix}
   0 & -2 \\
   1 & -1
\end{bmatrix}
$$
对方阵 $M$ ，给的行、列元素的**代数余子式**等于相应余子式的有符号行列式：
$$
c_{ij} = (-1)^{i+j} |M^{ij}|
$$
用 $c_{ij}$ 表示 $M$ 的第 $i$  行，第 $j$ 列元素的代数余子式。余子式式一个矩阵，而代数余子式式一个标量。

可以用余子式和代数余子式来计算任意 $n$ 维方阵的行列式，和矩阵的逆。

$n$ 维方阵的行列式存在着多个相等的定义。可以用代数余子式来定义矩阵的行列式（这种定义是递归的，因为代数余子式本身的定义就用到了矩阵的行列式）。

首先，从矩阵中任意选择一行或一列，对该行或列中的每个元素，都乘以对应的代数余子式。这些乘积的和就是矩阵的行列式。例如，任意选择一行，如行 $i$，行列式的计算过程如公式：
$$
|M| = \sum_{j=1}^n m_{ij} c_{ij} = \sum_{j=1}^n m_{ij} (-1)^{i+j} |M^{\{ij\}}|
$$

> - 矩阵积的行列式等于矩阵行列式的积：$|AB| = |A||B|$。
> - 这可以扩找到多个矩阵的情况：$|M_1M_2...M_{n-1}M_n| = |M_1||M_2|...|M_{n-1}||M_n|$。
> - 矩阵转置的行列式等于原矩阵的行列式：$|M^T| = |M|$。
> - 如果矩阵的任意行或列全为零，那么它的行列式等于零。
> - 交换矩阵的任意两行或两列，行列式变负。
> - 任意行或列的非零积加到另一行或列上不会改变行列式的值。

#### 几何解释

矩阵的行列式有着非常有趣的几何解释。2D 中，行列式等于以基向量为两边的平行四边形的有符号面积。3D中，行列式等于以变换后的基向量为三边的平行六面体的有符号体积。3D中，如果变换使得平行六面体“由里向外”翻转，则行列式变负。

行列式和矩阵变换导致的尺寸改变相关。其中行列式的绝对值和面积(2D)、体积(3D)的改变相关。行
列式的符号说明了变换矩阵是否包含镜象或投影。

矩阵的行列式还能对矩阵所代表的变换进行分类。如果矩阵行列式为零，那么该矩阵包含投影。如果矩阵行列式为负，那么该矩阵包含镜象。

### 矩阵的逆 

矩阵的求逆，这个运算只能用于方阵。

#### 运算法则

方阵 $M$ 的逆，记作 $M^{-1}$，也是一个矩阵，当 $M$ 与 $M^{-1}$ 乘时，结果是单位矩阵。公式表示为：
$$
M(M^{-1}) = M^{-1}M = I
$$
并非所有矩阵都有逆。一个明显的例子是若矩阵的某一行或列上的元素都为零，用任何矩阵乘以该矩阵，结果都是一个零矩阵。如果一个矩阵有逆矩阵，那么称它为**可逆**的或**非奇异**的。如果一个矩阵没有逆矩阵，则称它为**不可逆**的或**奇异矩阵**。奇异矩阵的行列式为零，非奇矩阵的行列式不为零，所以检测行列式的值是判断矩阵是否可逆的有效方法。此外，对于任意可逆矩阵 $M$，当且仅当 $v=0$ 时，$vM=0$ 。
$M$ 的 “标准伴随矩阵” 记作 “**adj M​**”，定义为 $M$ 的代数余子式矩阵的转置矩阵。

$M$ 的标准伴随矩阵是代数余子式矩阵的转置：
$$
adjM
=
\begin{bmatrix}
   c_{11} & c_{12} & c_{13} \\
   c_{21} & c_{22} & c_{23} \\
   c_{31} & c_{32} & c_{33}
\end{bmatrix}^T
= 
\begin{bmatrix}
   6 & -2 & -2 \\
   9 & 1 & 13 \\
   0 & -8 & -8
\end{bmatrix}^T
=
\begin{bmatrix}
   6 & 9 & 0 \\
   -2 & 1 & -8 \\
   -2 & 13 & -8
\end{bmatrix}
$$
有了标准伴随矩阵，通过除以 $M$ 的行列式，就能计算矩阵的逆。
$$
M^{-1} = {adjM \over |M|}
$$
例如，为了求得上面矩阵的逆，有：
$$
M^{-1} 
= 
{\begin{bmatrix}
   6 & 9 & 0 \\
   -2 & 1 & -8 \\
   -2 & 13 & -8
\end{bmatrix} \over -24}
=
\begin{bmatrix}
   -1/4 & -3/8 & 0 \\
   1/12 & -1/24 & 1/3 \\
   1/12 & -13/24 & 1/3
\end{bmatrix}
$$
当然还有其他方法可以用来计算矩阵的逆，比如高斯消元法。很多线性代数书都断定该方法更适合在计算机上实现，因为它所使用的代数运算较少，这种说法其实是不正确的。对于大矩阵或某些特殊矩阵来说，这也许是对的。然而，对于低阶矩阵，比如几何应用中常见的那些低阶矩阵，标准伴随矩阵可能更快一些。因为可以为标准伴随矩阵提供无分支（branchless）实现，这种实现方法在当今的超标量体系结构和专用向量处理器上会更快一些。

> - 如果 $M$ 时非奇异矩阵，则该矩阵的逆的逆等于原矩阵：$(M^{-1})^{-1} = M$ 。
> - 单位矩阵的逆是它本身：$I^{-1} = I$ 。
> - 矩阵转置的逆等于它的逆的转置：$(M^T)^{-1} = (M^{-1})^T$。
> - 矩阵乘积的逆等于矩阵的逆的相反顺序的乘积：$(AB)^{-1} = B^{-1}A^{-1}$。这可扩展到多个矩阵的情况：$(M_1M_2...M_{n-1}M_n) = M_n{^{-1}}M_{n-1}{^{-1}}...M_2{^{-1}}M_1{^{-1}}$。

#### 几何解释

矩阵的逆在几何上非常有用，因为它使得我们可以计算变换的“反向”或“相反”变换一一能“撤消”原变换的变换。所以，如果向量 $v$ 用矩阵 $M$ 来进行变换，接着用 $M$ 的逆 $M^{-1}$ 进行变换，将会得到原向量。
$$
(vM)M^{-1} = v(MM^{-1}) = vI = v
$$


### 正交矩阵

#### 运算法则

若方阵 $M$ 是正交的，则当且仅当 $M$ 与它转置 $M^T$ 的乘积等于单位矩阵：

$M$ 正交 <=> $MM^T = I$

已知，矩阵乘以它的逆等于单位矩阵：$MM^{-1}=I$。

所以，如果一个矩阵是正交的，那么它的转置等于它的逆，即：$M$ 正交 <=> $M^T = M^{-1}$

这是一条非常有用的性质，因为在实际应用中经常需要计算矩阵的逆，而3D图形计算中正交矩阵出现得又是如此频繁。例如，旋转和镜象矩阵是正交的。如果知道矩阵是正交的，就可以完全避免计算逆矩阵了，这也将大大减少计算量。

#### 几何解释

正交矩阵对我们非常有用，因为很容易计算它的逆矩阵。但怎样知道一个矩阵是否正交，以利用它的性质呢？

很多情况下，我们可以提前知道矩阵是如何建立的，甚至了解矩阵是仅包含旋转、镜象呢，还是二者皆有（记住:旋转和镜象矩阵是正交的）。

若一个矩阵是正交的，它必须满足下列条件：

- 矩阵的每一行都是单位向量。
- 矩阵的所有行相互垂直。

对矩阵的列也能得到类似的条件。这可得以下结论：如果 $M$ 是正交的，则 $M^T$ 也是正交的。

注意，有一个术语上的差别可能会导致轻微的混淆。线性代数中，如果一组向量互相垂直，这组向量就被认为是正交基（orthogonal basis）。它只要求所有向量互相垂直，并不要求所有向量都是单位向量。如果它们都是单位向量，则称它们为标准正交基（orthonormal basis）。



### 4x4齐次矩阵

4D 向量和 4x4 矩阵不过是对 3D 运算的一种方便的记法而已。

### 4D奇次空间

4D 向量有4个分量，前3个是标准的 x，y 和 z 分量，第四个是 w，有时称作**奇次坐标**。

#### 4 x 4 平移矩阵

用 4x4 矩阵实现 3D 平移：
$$
\begin{bmatrix}
   x & y & z & 1
\end{bmatrix}
\begin{bmatrix}
   1 & 0 & 0 & 0 \\
   0 & 1 & 0 & 0 \\
   0 & 0 & 1 & 0 \\
   ∆x & ∆y & ∆z & 1
\end{bmatrix}
=
\begin{bmatrix}
   x+∆x & y+∆y & z+∆z & 1
\end{bmatrix}
$$
在4D中，矩阵乘法仍然是线性变换。矩阵乘法不能表达4D中的“平移”，4D零向量也将总是被变换成零向量。这个技巧之所以能在3D中平移点是因为我们实际上是在切变4D空间。与实际3D空间相对应的4D中的“平面”并没有穿过4D中的原点。因此，我们能通过切变4D空间来实现3D中的平移。

#### 一般仿射变换

它们的基本思想是将变换的“中心点”平移到原点，用第8章的技术进行线性变换，然后再将“中心点”平移回原来的位置。开始使用平移矩阵 **T** 将点 **P** 移到原点，接着用线性变换矩阵 **R** 进行线性变换，最终的仿射变换矩阵 **M** 等于矩阵的积，即：$TRT^{-1}$。$T^{-1}$ 是平移矩阵，执行和 $T$ 相反的变换。

#### 透视投影

学习透视投影最好的方法是将它和我们已经学过一种投影一一平行投影相比较。怎样将3D空间投影到2D平面上，该平面称作**投影平面**，使用的是**正交投影**。正交投影也被称作**平行投影**，因为投影线都是平行的（投影线是指从原空间中的点到投影点的连线）。

3D中的透视投影仍然是投影到2D平面上。但是，投影线不再平行。实际上，它们相交于一点，该点称作**投影中心**。

因为投影中心在投影平面前面，投影线到达平面之前已经相交，所以投影平面上的图像是翻转的。当物体远离投影中心时，正交投影仍保持不变，但透视投影变小了。

离投影平面更远，它的投影比离投影平面较近的小。这是一种非常重要的视觉现象，称作：**透视缩略**。

#### 小孔成像

透视投影在图形学中非常重要，因为它是人类视觉系统的模型。实际上，人类视觉系统远比这复杂，因为我们有两只眼睛，而且对于每只眼睛，投影表面（视网膜）不是一个平面。...

#### 使用4x4矩阵进行透视投影



## 3D中的方位与角位移

p130








































